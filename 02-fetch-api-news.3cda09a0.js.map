{"version":3,"sources":["js/news-service.js","js/components/load-more-btn.js","js/02-fetch-api-news.js"],"names":["API_KEY","BASE_URL","options","headers","Authorization","NewsApiService","constructor","searchQuery","page","fetchArticles","url","fetch","then","response","json","articles","incrementPage","resetPage","query","newQuery","LoadMoreBtn","selector","hidden","refs","getRefs","hide","button","document","querySelector","label","spinner","enable","disabled","textContent","classList","add","disable","remove","show","searchForm","articlesContainer","loadMoreBtn","newsApiService","onSearch","e","preventDefault","currentTarget","elements","value","alert","clearArticlesContainer","appendArticlesMarkup","markup","map","urlToImage","title","author","description","join","insertAdjacentHTML","innerHTML","addEventListener"],"mappings":";AAQoC,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,aAAA,EARpC,MAAMA,EAAU,mCACVC,EAAW,yBACXC,EAAU,CACdC,QAAS,CACPC,cAAeJ,IAIJ,MAAMK,EACjBC,cACSC,KAAAA,YAAc,GACdC,KAAAA,KAAO,EAGhBC,gBACUC,MAAAA,KAAST,kBAAyB,KAAKM,2CAA2C,KAAKC,OAEtFG,OAAAA,MAAMD,EAAKR,GACbU,KAAKC,GAAYA,EAASC,QAC1BF,KAAK,EAAGG,SAAAA,MACAC,KAAAA,gBACED,IAInBC,gBACSR,KAAAA,MAAQ,EAGjBS,YACST,KAAAA,KAAO,EAGZU,YACO,OAAA,KAAKX,YAGZW,UAAMC,GACDZ,KAAAA,YAAcY,GA9BS,QAAA,QAAA;;ACRH,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,aAAA,EAAlB,MAAMC,EACnBd,aAAY,SAAEe,EAAF,OAAYC,GAAS,IAC1BC,KAAAA,KAAO,KAAKC,QAAQH,GAEzBC,GAAU,KAAKG,OAGjBD,QAAQH,GACAE,MAAAA,EAAO,GAKNA,OAJPA,EAAKG,OAASC,SAASC,cAAcP,GACrCE,EAAKM,MAAQN,EAAKG,OAAOE,cAAc,UACvCL,EAAKO,QAAUP,EAAKG,OAAOE,cAAc,YAElCL,EAGTQ,SACOR,KAAAA,KAAKG,OAAOM,UAAW,EACvBT,KAAAA,KAAKM,MAAMI,YAAc,eACzBV,KAAAA,KAAKO,QAAQI,UAAUC,IAAI,aAGlCC,UACOb,KAAAA,KAAKG,OAAOM,UAAW,EACvBT,KAAAA,KAAKM,MAAMI,YAAc,eACzBV,KAAAA,KAAKO,QAAQI,UAAUG,OAAO,aAGrCC,OACOf,KAAAA,KAAKG,OAAOQ,UAAUG,OAAO,aAGpCZ,OACOF,KAAAA,KAAKG,OAAOQ,UAAUC,IAAI,cAjCF,QAAA,QAAA;;AC2EhC,aA7DD,IAAA,EAAA,EAAA,QAAA,mBACA,EAAA,EAAA,QAAA,+BA4DC,SAAA,EAAA,GAAA,OAAA,GAAA,EAAA,WAAA,EAAA,CAAA,QAAA,GA1DD,MAAMZ,EAAO,CACXgB,WAAYZ,SAASC,cAAc,mBACnCY,kBAAmBb,SAASC,cAAc,2BAEtCa,EAAc,IAAIrB,EAAJ,QAAgB,CAClCC,SAAU,4BACVC,QAAQ,IAEJoB,EAAiB,IAAIrC,EAAJ,QAKvB,SAASsC,EAASC,GAKZF,GAJJE,EAAEC,iBAEFH,EAAexB,MAAQ0B,EAAEE,cAAcC,SAAS7B,MAAM8B,MAEzB,KAAzBN,EAAexB,MACV+B,OAAAA,MAAM,6BAGfR,EAAYH,OACZI,EAAezB,YACfiC,IACAzC,IAGF,SAASA,IACPgC,EAAYL,UACZM,EAAejC,gBAAgBG,KAAKG,IAClCoC,EAAqBpC,GACrB0B,EAAYV,WAIhB,SAASoB,EAAqBpC,GACtBqC,MAAAA,EAASrC,EACZsC,IACC,EAAG3C,IAAAA,EAAK4C,WAAAA,EAAYC,MAAAA,EAAOC,OAAAA,EAAQC,YAAAA,+BAE1B/C,qFAEK4C,uCACNC,iCACUC,qBACXC,8CAKRC,KAAK,IAERnC,EAAKiB,kBAAkBmB,mBAAmB,YAAaP,GAGzD,SAASF,IACP3B,EAAKiB,kBAAkBoB,UAAY,GA/CrCrC,EAAKgB,WAAWsB,iBAAiB,SAAUlB,GAC3CF,EAAYlB,KAAKG,OAAOmC,iBAAiB,QAASpD","file":"02-fetch-api-news.3cda09a0.js","sourceRoot":"../src","sourcesContent":["const API_KEY = '4330ebfabc654a6992c2aa792f3173a3';\nconst BASE_URL = 'https://newsapi.org/v2';\nconst options = {\n  headers: {\n    Authorization: API_KEY,\n  },\n};\n\nexport default class NewsApiService {\n    constructor() {\n        this.searchQuery = '';\n        this.page = 1;\n    }\n\n    fetchArticles() {\n        const url = `${BASE_URL}/everything?q=${this.searchQuery}&language=en&pageSize=5&page=${this.page}`;\n\n        return fetch(url, options)\n            .then(response => response.json())\n            .then(({ articles }) => {\n                this.incrementPage();\n                return articles;\n            });\n    }\n\n    incrementPage() {\n        this.page += 1;\n    }\n\n    resetPage() {\n        this.page = 1;\n    }\n\n    get query() {\n        return this.searchQuery;\n    }\n\n    set query(newQuery) {\n        this.searchQuery = newQuery;\n    }\n}","export default class LoadMoreBtn {\n  constructor({ selector, hidden = false }) {\n    this.refs = this.getRefs(selector);\n\n    hidden && this.hide();\n  }\n\n  getRefs(selector) {\n    const refs = {};\n    refs.button = document.querySelector(selector);\n    refs.label = refs.button.querySelector('.label');\n    refs.spinner = refs.button.querySelector('.spinner');\n\n    return refs;\n  }\n\n  enable() {\n    this.refs.button.disabled = false;\n    this.refs.label.textContent = 'Показать ещё';\n    this.refs.spinner.classList.add('is-hidden');\n  }\n\n  disable() {\n    this.refs.button.disabled = true;\n    this.refs.label.textContent = 'Загружаем...';\n    this.refs.spinner.classList.remove('is-hidden');\n  }\n\n  show() {\n    this.refs.button.classList.remove('is-hidden');\n  }\n\n  hide() {\n    this.refs.button.classList.add('is-hidden');\n  }\n}","/*\n * - Пагинация\n *   - страница и кол-во на странице\n * - Загружаем статьи при сабмите формы\n * - Загружаем статьи при нажатии на кнопку «Загрузить еще»\n * - Обновляем страницу в параметрах запроса\n * - Рисуем статьи\n * - Сброс значения при поиске по новому критерию\n *\n * https://newsapi.org/\n * 4330ebfabc654a6992c2aa792f3173a3\n * http://newsapi.org/v2/everything?q=cat&language=en&pageSize=5&page=1\n */\n\nimport NewsApiService from './news-service';//создали класс по fetch\nimport LoadMoreBtn from './components/load-more-btn';//создали класс по загрузке\n\nconst refs = {\n  searchForm: document.querySelector('.js-search-form'),\n  articlesContainer: document.querySelector('.js-articles-container'),\n};\nconst loadMoreBtn = new LoadMoreBtn({//экземпляр класса по загрузке\n  selector: '[data-action=\"load-more\"]',\n  hidden: true,\n});\nconst newsApiService = new NewsApiService();//экземпляр класса по fetch для получения обьекта с методами и свойствами\n\nrefs.searchForm.addEventListener('submit', onSearch);\nloadMoreBtn.refs.button.addEventListener('click', fetchArticles);\n\nfunction onSearch(e) {\n  e.preventDefault();\n\n  newsApiService.query = e.currentTarget.elements.query.value;\n\n  if (newsApiService.query === '') {\n    return alert('Введите что-то нормальное');\n  }\n\n  loadMoreBtn.show();\n  newsApiService.resetPage();\n  clearArticlesContainer();\n  fetchArticles();\n}\n\nfunction fetchArticles() {\n  loadMoreBtn.disable();\n  newsApiService.fetchArticles().then(articles => {\n    appendArticlesMarkup(articles);\n    loadMoreBtn.enable();\n  });\n}\n\nfunction appendArticlesMarkup(articles) {\n  const markup = articles\n    .map(\n      ({ url, urlToImage, title, author, description }) => `\n  <li>\n    <a href=\"${url}\" target=\"_blank\" rel=\"noopener noreferrer\">\n      <article>\n        <img src=\"${urlToImage}\" alt=\"\" width=\"480\">\n        <h2>${title}</h2>\n        <p>Posted by: ${author}</p>\n        <p>${description}</p>\n      </article>\n    </a>\n  </li>`\n    )\n    .join('');\n\n  refs.articlesContainer.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction clearArticlesContainer() {\n  refs.articlesContainer.innerHTML = '';\n}\n"]}